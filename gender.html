<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Hypertension</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="" />
	<meta name="keywords" content="" />
	<meta name="author" content="" />

  <!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- Place favicon.ico and apple-touch-icon.png in the root directory -->
	<link rel="shortcut icon" href="favicon.ico">

	<link href="https://fonts.googleapis.com/css?family=Karla:400,700" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700" rel="stylesheet">

	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">
	<!-- Owl Carousel -->
	<link rel="stylesheet" href="css/owl.carousel.min.css">
	<link rel="stylesheet" href="css/owl.theme.default.min.css">
	<!-- Magnific Popup -->
	<link rel="stylesheet" href="css/magnific-popup.css">

	<link rel="stylesheet" href="css/style.css">


	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<script src='https://d3js.org/d3.v4.min.js'></script>
	<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
	<script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>
	<link href="https://fonts.googleapis.com/css?family=Catamaran:100,200,300,400,500,600,700,800,900" rel="stylesheet">
	<link href="https://fonts.googleapis.com/css?family=Lato:100,100i,300,300i,400,400i,700,700i,900,900i" rel="stylesheet">
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

<style>
.slice {
		cursor: pointer;
}

.slice .main-arc {
		stroke: #fff;
		stroke-width: 1px;
}

.slice .hidden-arc {
		fill: none;
}

.slice text {
		pointer-events: none;
		dominant-baseline: middle;
		text-anchor: middle;
}
</style>
	</head>
	<body>
	<!-- <nav id="colorlib-main-nav" role="navigation">
		<a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle active"><i></i></a>
		<div class="js-fullheight colorlib-table">
			<div class="colorlib-table-cell js-fullheight">
				<div class="row">
					<div class="col-md-12">
						<div class="form-group">
							<input type="text" class="form-control" id="search" placeholder="Enter any key to search...">
							<button type="submit" class="btn btn-primary"><i class="icon-search3"></i></button>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<ul>
							<li><a href="index.html">Home</a></li>
							<li class="active"><a href="work.html">General</a></li>
							<li><a href="blog.html">Test</a></li>
							<li><a href="about.html">About</a></li>
							<li><a href="contact.html">Contact</a></li>
						</ul>
					</div>
				</div>
				<div class="row">
					<div class="col-md-12">
						<h2 class="head-title">Hypertension</h2>
						<a href="images/work-1.jpg" class="gallery image-popup-link text-center" style="background-image: url(images2/work-1.jpg);">
							<span><i class="icon-search3"></i></span>
						</a>
						<a href="images/work-2.jpg" class="gallery image-popup-link text-center" style="background-image: url(images2/work-2.jpg);">
							<span><i class="icon-search3"></i></span>
						</a>
						<a href="images/work-3.jpg" class="gallery image-popup-link text-center" style="background-image: url(images2/work-3.jpg);">
							<span><i class="icon-search3"></i></span>
						</a>
						<a href="images/work-4.jpg" class="gallery image-popup-link text-center" style="background-image: url(images2/work-4.jpg);">
							<span><i class="icon-search3"></i></span>
						</a>
					</div>
				</div>
			</div>
		</div>
	</nav> -->

	<div id="colorlib-page">
		<header>
			<div class="container">
				<div class="row">
					<div class="col-md-12">
						<div class="colorlib-navbar-brand">
							<a class="colorlib-logo" href="index.html" style="color: rgba(139,0,0)">Hypertension</a>
						</div>
						<!-- <a href="#" class="js-colorlib-nav-toggle colorlib-nav-toggle"><i></i></a> -->
					</div>
				</div>
			</div>
		</header>


		<div class="work-single-flex js-fullheight">
			<div class="col-half js-full-height work-img" id="genderChart" style="margin-top:8%; font-size: 300%">
			 </div>
<!-- <div id="genderChart"></div> -->
			<div class="col-half js-fullheight">
				<div class="display-t js-fullheight">
					<div class="display-tc js-fullheight" style="background-color: rgba(71,171,161,0.3);">
						<div class="work-desc">
							<h2>Detailed breakdown</h2>
							<p>
								The age-specific prevalence for hypertension rises markedly
								from age 40 years onwards. The age-specific prevalence of
								hypertension amongst those aged 60 to 69 years was 53.4% as
								compared to 7.6% in those aged 30 to 39 years.
								Although infrequently, hypertension also occurs in younger
								individuals and children, many of whom have secondary hypertension.
								The NHS 2010 found that 3.3% of Singapore residents aged 18 to 29 years
								had hypertension, compared with 4.2% in 2004. In contrast, majority of
								adult hypertensive patients have primary hypertension (i.e. without any defined causes).
								The NHS 2010 also found that the proportion of known hypertensive patients with good
								BP control (i.e. BP < 140/90 mmHg) was 67.4%, compared with 49.5% in 2004, while the
								proportion with good control among those receiving treatment was 69.1%, compared with
								52.9% in 2004. In addition, 26.3% of those found to have hypertension in the NHS 2010
								had not been previously diagnosed, compared with 38.5% in 2004.
							</p>
							<p><a href="work.html" class="btn-preview btn-hover">Back</a></p>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>

	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Owl Carousel -->
	<script src="js/owl.carousel.min.js"></script>
	<!-- Magnific Popup -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/magnific-popup-options.js"></script>

	<!-- Main JS (Do not remove) -->
	<script src="js/main.js"></script>


	</body>

	<!-- Chart starts-->
	<script>
		//slices size
		const width = (window.innerWidth + 500),
			height = (window.innerHeight + 1200),
			maxRadius = (Math.min(width, height) / 2) - 5;

		const formatNumber = d3.format(',d');

		const x = d3.scaleLinear()
			.range([0, 2 * Math.PI])
			.clamp(true);

		const y = d3.scaleSqrt()
			.range([maxRadius*.1, maxRadius]);

		//colour of slices
		const color = d3.scaleOrdinal(["#957DAD", "#D291BC", "#E0EEB4", "#FEC8D8", "#FEBCC8", "#E0FEFE", "#EAEBFF", "#FFDFD3"]);
		// const color = d3.scaleOrdinal(d3.schemeCategory20);

		const partition = d3.partition();

		const arc = d3.arc()
			.startAngle(d => x(d.x0))
			.endAngle(d => x(d.x1))
			.innerRadius(d => Math.max(0, y(d.y0)))
			.outerRadius(d => Math.max(0, y(d.y1)));

		const middleArcLine = d => {
			const halfPi = Math.PI/2;
			const angles = [x(d.x0) - halfPi, x(d.x1) - halfPi];
			const r = Math.max(0, (y(d.y0) + y(d.y1)) / 2);

			const middleAngle = (angles[1] + angles[0]) / 2;
			const invertDirection = middleAngle > 0 && middleAngle < Math.PI; // On lower quadrants write text ccw
			if (invertDirection) { angles.reverse(); }

			const path = d3.path();
			path.arc(0, 0, r, angles[0], angles[1], invertDirection);
			return path.toString();
		};

		const textFits = d => {
			const CHAR_SPACE = 6;

			const deltaAngle = x(d.x1) - x(d.x0);
			const r = Math.max(0, (y(d.y0) + y(d.y1)) / 2);
			const perimeter = r * deltaAngle;

			return d.data.name.length * CHAR_SPACE < perimeter;
		};
		// end of slices size

		//slices animation
		const svg = d3.select('#genderChart').append('svg')
			.style('width', '50vw')
			.style('height', '80vh')
			.attr('width', 900)
			.attr('height', 900)
			.attr('viewBox', `${-width / 2} ${-height / 2} ${width} ${height}`)
			.on('click', () => focusOn()); // Reset zoom on canvas click

		d3.json('https://raw.githubusercontent.com/hesterh/HCI4/master/JSON/testData1.json', (error, root) => {
			if (error) throw error;

			root = d3.hierarchy(root);
			root.sum(d => d.size);

			const slice = svg.selectAll('g.slice')
				.data(partition(root).descendants());


			slice.exit().remove();

			//to expend slices  partition(root).descendants()
			const newSlice = slice.enter()
				.append('g').attr('class', 'slice')
				.on('click', d => {
					d3.event.stopPropagation();
					focusOn(d);
				});

			newSlice.append('title')
				.text(d => d.data.name + '\n' + formatNumber(d.value));

			newSlice.append('path')
				.attr('class', 'main-arc')
				.style('fill', d => color((d.children ? d : d.parent).data.name))
				.attr('d', arc);

			newSlice.append('path')
				.attr('class', 'hidden-arc')
				.attr('id', (_, i) => `hiddenArc${i}`)
				.attr('d', middleArcLine);

			const text = newSlice.append('text')
				.attr('display', d => textFits(d) ? null : descendants());

			// Add white contour
			text.append('textPath')
				.attr('startOffset','50%')
				.attr('xlink:href', (_, i) => `#hiddenArc${i}` )
				.text(d => d.data.name)
				.style('fill', 'none')
				.style('stroke', '#fff')
				.style('stroke-width', 5)
				.style('stroke-linejoin', 'round');

			text.append('textPath')
				.attr('startOffset','50%')
				.attr('xlink:href', (_, i) => `#hiddenArc${i}` )
				.text(d => d.data.name);
		});

		function focusOn(d = { x0: 0, x1: 1, y0: 0, y1: 1 }) {
			// Reset to top-level if no data point specified

			//transition of the slices
			const transition = svg.transition()
				.duration(750)
				.tween('scale', () => {
					const xd = d3.interpolate(x.domain(), [d.x0, d.x1]),
						yd = d3.interpolate(y.domain(), [d.y0, 1]);
					return t => { x.domain(xd(t)); y.domain(yd(t)); };
				});

			transition.selectAll('path.main-arc')
				.attrTween('d', d => () => arc(d));

			transition.selectAll('path.hidden-arc')
				.attrTween('d', d => () => middleArcLine(d));

			transition.selectAll('text')
				.attrTween('display', d => () => textFits(d) ? null : 'none');

			moveStackToFront(d);

			function moveStackToFront(elD) {
				svg.selectAll('.slice').filter(d => d === elD)
					.each(function(d) {
						this.parentNode.appendChild(this);
						if (d.parent) { moveStackToFront(d.parent); }
					})
			}
		}
	</script>
</html>
